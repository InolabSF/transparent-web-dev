{"version":3,"sources":["webpack:///./src/views/Meeting.vue?56ff","webpack:///./src/views/Meeting.vue?606c","webpack:///src/views/Meeting.vue","webpack:///./src/views/Meeting.vue?8f24","webpack:///./src/views/Meeting.vue?efce"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Meeting_vue_vue_type_style_index_0_id_8936330a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Meeting_vue_vue_type_style_index_0_id_8936330a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","layer","i","style","getComputedStyleForLayer","getRandomStyleForKeyWord","_v","_s","words","content","key","id","getRandomStyleForImage","attrs","src","img_url","stat","ref","refName","refInFor","staticRenderFns","START_Z_AXIS","Z_STEP","SHOW_LAYER_NUM","Meetingvue_type_script_lang_js_","name","created","opts","wallId","$route","params","startRecognizeSpeachSDK","fetchTranscripts","listenPersonalTouch","data","layers","isShowContentDetailModal","currentContentDetailModalFloor","contextMenuStatuses","computed","methods","window","addEventListener","onClickTable","isTouchObjectByElement","touch","elm","x","offsetLeft","offsetWidth","y","offsetTop","offsetHeight","isTouchObjectByRect","_ref","width","height","_fetchTranscripts","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","url","res","_res$data","searches","related_contents","wrap","_context","prev","next","concat","ApiClient","get","sent","search_first_index","search_last_index","related_content_last_index","map","s","filter","r","transcript_id","stop","apply","arguments","onClickThumbnail","evt","detail","existRef","$refs","floorId","d","length","openContextMenu","getBoundingClientRect","closeContextMenu","left","top","status","push","getStyleByContextMenuPosition","openPinList","createPin","removePin","offRecord","leave","exitWall","removeContent","removeWord","lodash_default","a","random","innerWidth","innerHeight","x0","y0","index","z","alpha","zIndex","transform","opacity","views_Meetingvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"kHAAA,IAAAA,EAAAC,EAAA,QAAAC,EAAAD,EAAAE,EAAAH,GAAmiBE,EAAG,qECAtiB,IAAAE,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,YAAsBF,EAAA,OAAYE,YAAA,uBAAiCF,EAAA,OAAYE,YAAA,cAAyBN,EAAAO,GAAAP,EAAA,gBAAAQ,EAAAC,GAAuC,OAAAL,EAAA,OAAiBE,YAAA,QAAAI,MAAAV,EAAAW,yBAAAF,KAA4DL,EAAA,OAAYE,YAAA,cAAAI,MAAAV,EAAAY,6BAAiEZ,EAAAa,GAAAb,EAAAc,GAAAN,EAAAO,MAAA,OAAAf,EAAAO,GAAAC,EAAA,0BAAAQ,GAAqF,OAAAZ,EAAA,OAAiBa,IAAAD,EAAAE,GAAAZ,YAAA,aAAAI,MAAAV,EAAAmB,yBAAAC,OAAoFC,IAAAL,EAAAM,cAAyB,QAAMtB,EAAAO,GAAAP,EAAA,6BAAAuB,GAAqD,OAAAnB,EAAA,OAAkBoB,IAAAD,EAAAE,QAAAC,UAAA,EAAApB,YAAA,eAAAI,MAAAa,EAAA,QAA6EvB,EAAAa,GAAA,oCAA0C,IAC1yBc,8FC8BAC,EAAA,GACAC,EAAA,GACAC,EAAA,GAEAC,GACAC,KAAA,UACAC,QAFA,WAGA,IAAAC,GACAC,OAAAlC,KAAAmC,OAAAC,OAAAF,QAEAG,wBAAAJ,GAEAjC,KAAAsC,mBACAtC,KAAAuC,uBAEAC,KAXA,WAYA,OACAC,UACAC,0BAAA,EACAC,gCAAA,EACAC,yBAGAC,YAGAC,SACAP,oBADA,WAEAQ,OAAAC,iBAAA,qBAAAhD,KAAAiD,eAEAC,uBAJA,SAIAC,EAAAC,GACA,OACAD,EAAAE,GAAAD,EAAAE,WAAAF,EAAAG,aACAJ,EAAAE,GAAAD,EAAAE,YACAH,EAAAK,GAAAJ,EAAAK,UAAAL,EAAAM,cACAP,EAAAK,GAAAJ,EAAAK,WAOAE,oBAhBA,SAgBAR,EAhBAS,GAgBA,IAAAP,EAAAO,EAAAP,EAAAG,EAAAI,EAAAJ,EAAAK,EAAAD,EAAAC,MAAAC,EAAAF,EAAAE,OACA,OACAX,EAAAE,KAAAQ,GACAV,EAAAE,MACAF,EAAAK,KAAAM,GACAX,EAAAK,MAOAlB,iBA5BA,eAAAyB,EAAAC,OAAAC,EAAA,KAAAD,CAAAE,mBAAAC,KAAA,SAAAC,IAAA,IAAAlC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAhC,EAAA,OAAAyB,mBAAAQ,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cA6BA3C,EAAAlC,KAAAmC,OAAAC,OAAAF,OACAmC,EA9BA,oBAAAS,OA8BA5C,GA9BAyC,EAAAE,KAAA,EA+BAE,EAAA,KAAAC,IAAAX,GA/BA,OA+BAC,EA/BAK,EAAAM,KAAAV,EAwCAD,EAAA9B,KALAgC,EAnCAD,EAmCAC,SAnCAD,EAoCAW,mBApCAX,EAqCAY,kBACAV,EAtCAF,EAsCAE,iBAtCAF,EAuCAa,2BAGA3C,EAAA+B,EAAAa,IAAA,SAAAC,GAEA,OADAA,EAAAb,mBAAAc,OAAA,SAAAC,GAAA,OAAAA,EAAAC,gBAAAH,EAAAG,gBACAH,IAGAtF,KAAAyC,SA/CA,wBAAAkC,EAAAe,SAAAtB,EAAApE,SAAA,yBAAA+D,EAAA4B,MAAA3F,KAAA4F,YAAA,GAiDAC,iBAjDA,aAqDA5C,aArDA,SAqDA6C,GAEA,IAAA3C,EAAA2C,EAAAC,OAAA,GAEAC,EAAAhG,KAAAiG,MAAA,gBAAAnB,OAAA3B,EAAA+C,UAKA,IAHAlG,KAAA4C,oBACA2C,OACA,SAAAY,GAAA,OAAAA,EAAAD,UAAA/C,EAAA+C,UACAE,OACApG,KAAAqG,gBAAAlD,GAEA6C,IACAhG,KAAA2D,oBAAAR,EAAA6C,EAAA,GAAAM,0BAEAtG,KAAAuG,iBAAApD,IAGAkD,gBAvEA,SAuEAlD,GACA,IAAA1C,GACA+F,KAAA,GAAA1B,OAAA3B,EAAAE,EAAA,MACAoD,IAAA,GAAA3B,OAAA3B,EAAAK,EAAA,OAEAhC,EAAA,gBAAAsD,OAAA3B,EAAA+C,SACAQ,GACAR,QAAA/C,EAAA+C,QACAzF,QACAe,WAEAxB,KAAA4C,oBAAA+D,KAAAD,IAEAH,iBApFA,SAoFApD,GACA,IAAA+C,EAAA/C,EAAA+C,QACAlG,KAAA4C,oBAAA5C,KAAA4C,oBAAA2C,OAAA,SAAAD,GAAA,OAAAA,EAAAY,eAEAU,8BAxFA,aA2FAC,YA3FA,aA8FAC,UA9FA,aAiGAC,UAjGA,aAoGAC,UApGA,aAuGAC,MAvGA,aA0GAC,SA1GA,aA6GAC,cA7GA,aAgHAC,WAhHA,aAmHAlG,uBAnHA,WAoHA,IAAAmC,EAAAgE,EAAAC,EAAAC,OAAAxE,OAAAyE,YACAhE,EAAA6D,EAAAC,EAAAC,OAAAxE,OAAA0E,aACAhH,GACA+F,KAAA,GAAA1B,OAAAzB,EAAA,MACAoD,IAAA,GAAA3B,OAAAtB,EAAA,OAEA,OAAA/C,GAEAE,yBA5HA,WA6HA,IAAA+G,EAAA,IACAC,EAAA,IACAtE,EAAAgE,EAAAC,EAAAC,OAAAG,EAAA3E,OAAAyE,WAAAE,GACAlE,EAAA6D,EAAAC,EAAAC,OAAAI,EAAA5E,OAAA0E,YAAAE,GACAlH,GACA+F,KAAA,GAAA1B,OAAAzB,EAAA,MACAoD,IAAA,GAAA3B,OAAAtB,EAAA,OAEA,OAAA/C,GAEAC,yBAvIA,SAuIAkH,GACA,IAAAC,EAAAlG,EAAAiG,EAAAhG,EACAkG,EAAA,MAAAF,EACAG,EAAAlG,EAAA+F,EACAnH,GACAuH,UAAA,yBAAAlD,OAAA+C,EAAA,OACAI,QAAAH,EACAC,UAEA,OAAAtH,KCzMiVyH,EAAA,0BCQjVC,EAAgBnE,OAAAoE,EAAA,KAAApE,CACdkE,EACApI,EACA4B,GACF,EACA,KACA,WACA,MAIAyG,EAAAE,QAAAC,OAAA,cACeC,EAAA,WAAAJ","file":"static/js/chunk-16be8818.6b39177c.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Meeting.vue?vue&type=style&index=0&id=8936330a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Meeting.vue?vue&type=style&index=0&id=8936330a&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_c('div',{staticClass:\"layer-list-wrapper\"},[_c('div',{staticClass:\"layer-list\"},_vm._l((_vm.layers),function(layer,i){return _c('div',{staticClass:\"layer\",style:(_vm.getComputedStyleForLayer(i))},[_c('div',{staticClass:\"layer__word\",style:(_vm.getRandomStyleForKeyWord())},[_vm._v(_vm._s(layer.words[0]))]),_vm._l((layer.related_contents),function(content){return _c('img',{key:content.id,staticClass:\"layer__img\",style:(_vm.getRandomStyleForImage()),attrs:{\"src\":content.img_url}})})],2)}))]),_vm._l((_vm.contextMenuStatuses),function(stat){return [_c('div',{ref:stat.refName,refInFor:true,staticClass:\"context-menu\",style:(stat.style)},[_vm._v(\"\\n      context menu\\n    \")])]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <!--<h1>Let's Talk!!</h1>-->\n  <!--レイヤーと奥行き表示ロジック-->\n  <!--<div>TODO コンテキストメニュー＋QRコード</div>-->\n  <!--<div>TODO コンテキスト（leave確認）</div>-->\n  <div class=\"wrapper\">\n    <div class=\"layer-list-wrapper\">\n      <div class=\"layer-list\">\n        <div class=\"layer\" :style=\"getComputedStyleForLayer(i)\" v-for=\"layer, i in layers\">\n          <div class=\"layer__word\" :style=\"getRandomStyleForKeyWord()\">{{ layer.words[0] }}</div>\n          <img class=\"layer__img\" :style=\"getRandomStyleForImage()\" v-for=\"content in layer.related_contents\" :key=\"content.id\" :src=\"content.img_url\" />\n        </div>\n      </div>\n    </div>\n    <template v-for=\"stat in contextMenuStatuses\">\n      <div\n        class=\"context-menu\"\n        :style=\"stat.style\"\n        :ref=\"stat.refName\"\n      >\n        context menu\n      </div>\n    </template>\n\n  </div>\n</template>\n\n<script>\nimport client from \"@/core/ApiClient\";\nimport _ from \"lodash\";\n\nconst START_Z_AXIS = 50; // 先頭z座標\nconst Z_STEP = 10; // 1レイヤー間のz深度\nconst SHOW_LAYER_NUM = 10 // 階層数\n\nexport default {\n  name: \"Meeting\",\n  created() {\n    const opts = {\n      wallId: this.$route.params.wallId\n    };\n    startRecognizeSpeachSDK(opts);\n    // TODO transcriptsの取得\n    this.fetchTranscripts();\n    this.listenPersonalTouch();\n  },\n  data() {\n    return {\n      layers: [],\n      isShowContentDetailModal: false,\n      currentContentDetailModalFloor: false,\n      contextMenuStatuses: []\n    }\n  },\n  computed: {\n\n  },\n  methods: {\n    listenPersonalTouch() {\n      window.addEventListener('CUSTOM_TOUCH_START', this.onClickTable);\n    },\n    isTouchObjectByElement(touch, elm) {\n      if (\n        touch.x <= elm.offsetLeft + elm.offsetWidth &&\n        touch.x >= elm.offsetLeft &&\n        touch.y <= elm.offsetTop + elm.offsetHeight &&\n        touch.y >= elm.offsetTop\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    isTouchObjectByRect(touch, {x, y, width, height}) {\n      if (\n        touch.x <= x + width &&\n        touch.x >= x &&\n        touch.y <= y + height &&\n        touch.y >= y\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    async fetchTranscripts() {\n      const wallId = this.$route.params.wallId;\n      const url = `/api/transcripts/${wallId}`;\n      const res = await client.get(url);\n\n      // 整形\n      const {\n        searches,\n        search_first_index,\n        search_last_index,\n        related_contents,\n        related_content_last_index\n      } = res.data;\n\n      const layers = searches.map(s => {\n        s.related_contents = related_contents.filter(r => ( r.transcript_id === s.transcript_id ));\n        return s;\n      });\n\n      this.layers = layers;\n    },\n    onClickThumbnail() {\n      // TODO モーダル開く\n      // ID識別で向きを変える\n    },\n    onClickTable(evt) {\n      // TODO 長押しで開く\n      const touch = evt.detail[0];\n      // NOTE: refsは配列で返ってくる\n      const existRef = this.$refs[`context-menu-${touch.floorId}`];\n      if (\n        this.contextMenuStatuses\n          .filter(\n            d => (d.floorId === touch.floorId)\n          ).length === 0) {\n        this.openContextMenu(touch);\n      } else if (\n        existRef &&\n        !this.isTouchObjectByRect(touch, existRef[0].getBoundingClientRect())\n      ) {\n        this.closeContextMenu(touch);\n      }\n    },\n    openContextMenu(touch) {\n      const style = {\n        left: `${touch.x}px`,\n        top: `${touch.y}px`,\n      };\n      const refName = `context-menu-${touch.floorId}`;\n      const status = {\n        floorId: touch.floorId,\n        style,\n        refName\n      };\n      this.contextMenuStatuses.push(status);\n    },\n    closeContextMenu(touch) {\n      const floorId = touch.floorId;\n      this.contextMenuStatuses = this.contextMenuStatuses.filter(s => s.floorId !== floorId);\n    },\n    getStyleByContextMenuPosition() {\n      // TODO タッチ位置に合わせて出す位置調整\n    },\n    openPinList() {\n      // ピン一覧\n    },\n    createPin() {\n      // TODO ピンする\n    },\n    removePin() {\n      // TODO アンピンする\n    },\n    offRecord() {\n      // TODO オフレコにする\n    },\n    leave() {\n      // TODO 退席\n    },\n    exitWall() {\n      // TODO 会議終了\n    },\n    removeContent() {\n      // TODO コンテンツを消す\n    },\n    removeWord() {\n      // TODO ワードを消す\n    },\n    getRandomStyleForImage() {\n      const x = _.random(window.innerWidth);\n      const y = _.random(window.innerHeight);\n      const style = {\n        left: `${x}px`,\n        top: `${y}px`,\n      };\n      return style;\n    },\n    getRandomStyleForKeyWord() {\n      const x0 = 800;\n      const y0 = 600;\n      const x = _.random(x0, window.innerWidth - x0);\n      const y = _.random(y0, window.innerHeight - y0);\n      const style = {\n        left: `${x}px`,\n        top: `${y}px`,\n      };\n      return style;\n    },\n    getComputedStyleForLayer(index) {\n      const z = START_Z_AXIS - (index * Z_STEP);\n      const alpha = 1 - (index * 0.08);\n      const zIndex = SHOW_LAYER_NUM - index;\n      const style = {\n        transform: `translate3D(0px, 0px, ${z}px)`,\n        opacity: alpha,\n        zIndex\n      };\n      return style;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.wrapper {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.layer-list-wrapper {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  perspective: 100px;\n  perspective-origin: center center;\n\n  // TODO仮\n  font-size: 10rem;\n}\n\n.layer-list {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  transform-origin: center center;\n  transform-style: preserve-3D;\n}\n\n.layer {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n}\n\n.layer__img {\n  position: absolute;\n  max-width: 600px;\n  max-height: 600px;\n}\n\n.layer__word {\n  position: absolute;\n  color: darkred;\n  font-weight: bold;\n}\n\n.context-menu {\n  position: absolute;\n  width: 400px;\n  height: 600px;\n  background: #f2f2f2;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Meeting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Meeting.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Meeting.vue?vue&type=template&id=8936330a&scoped=true&\"\nimport script from \"./Meeting.vue?vue&type=script&lang=js&\"\nexport * from \"./Meeting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Meeting.vue?vue&type=style&index=0&id=8936330a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8936330a\",\n  null\n  \n)\n\ncomponent.options.__file = \"Meeting.vue\"\nexport default component.exports"],"sourceRoot":""}